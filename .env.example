# Decentralized Sequencer Environment Variables
# Copy this file to .env and configure as needed

# ============================================
# CORE CONFIGURATION
# ============================================

# Unique identifier for this sequencer instance
SEQUENCER_ID=unified-sequencer-1

# P2P port for libp2p networking
P2P_PORT=9001

# Redis configuration (required for dequeuer functionality)
REDIS_HOST=localhost        # Hostname or IP (use 'redis' for Docker)
REDIS_PORT=6379            # Port number
REDIS_DB=0                 # Database number (0-15)
REDIS_PASSWORD=            # Password (leave empty if no auth)

# ============================================
# P2P NETWORK CONFIGURATION
# ============================================

# Bootstrap node multiaddr (REQUIRED for P2P)
# Format: /ip4/<IP>/tcp/<PORT>/p2p/<PEER_ID>
# Example: /ip4/YOUR.SERVER.IP.HERE/tcp/9100/p2p/YOUR_PEER_ID_HERE
BOOTSTRAP_MULTIADDR=

# Rendezvous point for peer discovery (REQUIRED for finding other peers)
# This must match what other peers are using
RENDEZVOUS_POINT=powerloom-snapshot-sequencer-network

# Private key for P2P identity (optional - will generate if not provided)
# Format: hex-encoded Ed25519 private key
# Leave empty to generate a new key on each start
PRIVATE_KEY=

# ============================================
# COMPONENT TOGGLES
# ============================================

# Enable/disable individual components (true/false)
ENABLE_LISTENER=true      # P2P gossipsub listener
ENABLE_DEQUEUER=true      # Redis queue processor
ENABLE_FINALIZER=true     # Batch finalizer
ENABLE_CONSENSUS=true     # Consensus voting
ENABLE_EVENT_MONITOR=false # Event monitor for EpochReleased events

# ============================================
# DEQUEUER CONFIGURATION
# ============================================

# Number of concurrent dequeue workers
DEQUEUER_WORKERS=5

# For Docker Compose scaling (number of dequeuer containers)
DEQUEUER_REPLICAS=3

# ============================================
# FINALIZER CONFIGURATION 
# (ONLY NEEDED IF ENABLE_FINALIZER=true)
# ============================================
# The finalizer component handles batch finalization and storage
# These settings are inherited from the centralized sequencer
# and are NOT needed for basic submission listening/processing

# Number of finalizer instances (for redundancy)
FINALIZER_REPLICAS=2

# Storage provider: ipfs, arweave, filecoin
# NOTE: Requires corresponding storage service to be running
STORAGE_PROVIDER=ipfs

# IPFS node address (ONLY if using IPFS for finalized batch storage)
# You need to run an IPFS node separately if finalizer is enabled
IPFS_HOST=localhost:5001
# For Docker: use ipfs:5001

# Data availability layer: none, eigenda, celestia, avail
# For future integration with DA layers
DA_PROVIDER=none

# ============================================
# BLOCKCHAIN CONFIGURATION
# ============================================

# Powerloom Protocol Chain RPC Configuration
# All RPC interactions in this component are with the Powerloom chain only
POWERLOOM_RPC_NODES=["http://localhost:8545","http://localhost:8546"]

# Powerloom Archive nodes for historical queries (optional, JSON array)
POWERLOOM_ARCHIVE_RPC_NODES=[]

# Source Chain RPC Configuration (JSON array)
# where data is sourced from (e.g., Ethereum, Polygon)
SOURCE_RPC_NODES=["https://eth-mainnet.g.alchemy.com/v2/YOUR_API_KEY","https://mainnet.infura.io/v3/YOUR_KEY"]

# Source Archive nodes (optional, JSON array)
SOURCE_ARCHIVE_RPC_NODES=[]

# Chain ID (1=mainnet, 5=goerli, 11155111=sepolia)
CHAIN_ID=1

# Protocol State Contract (REQUIRED for event monitoring)
PROTOCOL_STATE_CONTRACT=0xE88E5f64AEB483d7057645326AdDFA24A3B312DF

# Future: LibP2P Identity Registry Contract
IDENTITY_REGISTRY_CONTRACT=

# Data Market Addresses (JSON array or comma-separated)
# These are the markets this sequencer will monitor
DATA_MARKET_ADDRESSES=["0x0C2E22fe7526fAeF28E7A58c84f8723dEFcE200c"]

# ============================================
# EVENT MONITORING CONFIGURATION
# ============================================

# Enable event monitoring for EpochReleased events
ENABLE_EVENT_MONITOR=false

# Submission window duration in seconds (how long to accept submissions after epoch)
SUBMISSION_WINDOW_DURATION=60

# Maximum concurrent submission windows
MAX_CONCURRENT_WINDOWS=100

# Event polling interval in seconds
EVENT_POLL_INTERVAL=12

# Starting block for event monitoring (0 = latest)
EVENT_START_BLOCK=0

# Number of blocks to process in batch
EVENT_BLOCK_BATCH_SIZE=1000

# ============================================
# IDENTITY & VERIFICATION
# ============================================

# Full node addresses (JSON array or comma-separated)
# These addresses bypass certain verification checks by the dequeuer
FULL_NODE_ADDRESSES=

# Skip identity verification (for testing only)
SKIP_IDENTITY_VERIFICATION=false

# Check for flagged snapshotters
CHECK_FLAGGED_SNAPSHOTTERS=true

# Verification cache TTL in seconds
VERIFICATION_CACHE_TTL=600


# ============================================
# DEDUPLICATION CONFIGURATION
# ============================================

# Enable deduplication
DEDUP_ENABLED=true

# Local cache size for deduplication
DEDUP_LOCAL_CACHE_SIZE=10000

# Deduplication TTL in seconds
DEDUP_TTL_SECONDS=7200

# ============================================
# PERFORMANCE TUNING
# ============================================

# Connection manager settings
CONN_MANAGER_LOW_WATER=100
CONN_MANAGER_HIGH_WATER=400

# Gossipsub heartbeat interval in milliseconds
GOSSIPSUB_HEARTBEAT_MS=700

# Maximum submissions per epoch
MAX_SUBMISSIONS_PER_EPOCH=100

# ============================================
# DEBUGGING & MONITORING
# ============================================

# Enable debug logging (true/false)
DEBUG_MODE=false
LOG_LEVEL=info

# Metrics port for Prometheus
METRICS_PORT=9090
METRICS_ENABLED=false

# Slack webhook for alerts (optional)
SLACK_WEBHOOK_URL=

# API configuration
API_HOST=0.0.0.0
API_PORT=8080
API_AUTH_TOKEN=

# ============================================
# QUICK START CONFIGURATIONS
# ============================================

# For LOCAL TESTING (everything on one machine):
# - Use defaults above
# - Set REDIS_ADDR=localhost:6379
# - Leave PRIVATE_KEY empty (will auto-generate)
# - Set DEBUG_MODE=true

# For DOCKER COMPOSE:
# - Set REDIS_ADDR=redis:6379
# - Set IPFS_HOST=ipfs:5001
# - Use the bootstrap multiaddr above

# For PRODUCTION:
# - Generate unique PRIVATE_KEY for each instance
# - Set proper RPC_URL with your API key
# - Set DEBUG_MODE=false
# - Configure STORAGE_PROVIDER and DA_PROVIDER as needed